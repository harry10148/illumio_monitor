import locale
_current_lang = "en"

def set_language(lang: str):
    global _current_lang
    if lang in ["en", "zh_TW"]:
        _current_lang = lang

def get_language() -> str:
    return _current_lang

MESSAGES = {
    "en": {
        # General & Errors
        "error_loading_config": "Error loading config: {error}",
        "config_saved": "Configuration saved.",
        "error_saving_config": "Error saving config: {error}",
        "rule_overwritten": "Rule already exists, updated configuration.",
        "rule_deleted": "Deleted: {name}",
        "loading_best_practices": "Loading Best Practices (will clear existing rules)...",
        "press_enter_to_continue": "Press Enter to continue...",
        "operation_cancelled": "Operation cancelled.",
        "done": "Done.",
        "bye": "Bye.",
        
        # Menu Titles
        "main_menu_title": "=== Illumio PCE Monitor ===",
        "main_menu_api": "API: {url} | Rules: {count}",
        "main_menu_1": "1. Add Event Rule (inc. PCE Health Check)",
        "main_menu_2": "2. Add Traffic Rule",
        "main_menu_3": "3. Add Bandwidth & Volume Rule",
        "main_menu_4": "4. Manage Rules (List/Delete)",
        "main_menu_5": "5. System Settings (API / Email / Alerts)",
        "main_menu_6": "6. Load Official Best Practices",
        "main_menu_7": "7. Send Test Alert",
        "main_menu_8": "8. Run Monitor Once",
        "main_menu_9": "9. Traffic Rule Debug Mode",
        "main_menu_10": "10. Launch Web GUI",
        "main_menu_0": "0. Exit",
        "please_select": "Please select",
        "starting_web_gui": "Starting Web GUI at",
        
        # Add Rules Menus
        "menu_add_event_title": "=== Add Event Monitor Rule ===",
        "menu_return": "0. Return",
        "menu_cancel": "0. Cancel",
        "set_health_check": "H. Toggle PCE Health Check (Current: {status})",
        "select_category": "Select category (Number, H for Health Check, 0 to return): ",
        "select_event": "Select Event",
        "rule_trigger_type_1": "1. Immediate Alert",
        "rule_trigger_type_2": "2. Cumulative Count",
        "cumulative_count": "Cumulative Count",
        "hint_example_5": "e.g.: 5",
        "time_window_mins": "Time Window (mins)",
        "hint_example_10": "e.g.: 10",
        "cooldown_mins_default": "Cooldown Time (mins) [Default: {win}]",
        "rule_saved": "Rule saved. Press Enter to continue...",
        
        "menu_add_traffic_title": "=== Add Traffic Rule (Blocked/Potential) ===",
        "rule_name": "Rule Name (e.g.: Blocked SSH)",
        "policy_decision": "Policy Decision:",
        "pd_1": "1. \033[91mBlocked\033[0m",
        "pd_2": "2. \033[93mPotential\033[0m",
        "pd_3": "3. \033[92mAllowed\033[0m",
        "pd_4": "4. All",
        "pd_select_default": "Select [Default: 1]",
        "advanced_filters": "--- Advanced Filters ---",
        "port_input": "Port (e.g., 80, 443) [Press Enter to skip]",
        "proto_select": "Protocol (1. TCP, 2. UDP, 0. Both) [Default: Both]",
        "src_input": "Source Label/IP/CIDR (e.g., role=Web, 10.0.0.0/8, 192.168.1.1) [Press Enter to skip]",
        "dst_input": "Dest Label/IP/CIDR (e.g., app=DB, 10.1.1.0/24, 192.168.1.5) [Press Enter to skip]",
        "trigger_threshold_count": "Trigger Threshold (count) [Default: 10]",
        "excludes_optional": "--- Excludes (Optional) ---",
        "ex_port_input": "Exclude Port (e.g., 22) [Press Enter to skip]",
        "ex_src_input": "Exclude Source Label/IP/CIDR (e.g., env=Kube, 10.9.9.9) [Press Enter to skip]",
        "ex_dst_input": "Exclude Dest Label/IP/CIDR (e.g., 8.8.8.8) [Press Enter to skip]",
        "traffic_rule_saved": "Traffic Rule added. Press Enter to continue...",
        
        "menu_add_bw_vol_title": "=== Add Bandwidth & Volume Rule ===",
        "rule_name_bw": "Rule Name (e.g.: Database Spike)",
        "step_1_metric": "--- 1. Select Metric ---",
        "metric_1": "1. Bandwidth - Applicable for transmission rate (Mbps)",
        "metric_2": "2. Total Volume - Applicable for data exfiltration (MB/GB)",
        "step_2_filters": "--- 2. Filters ---",
        "step_3_threshold": "--- 3. Threshold ---",
        "trigger_threshold_unit": "Trigger Threshold ({unit})",
        "time_window_mins_default_5": "Time Window (mins) [Default: 5]",
        
        "menu_manage_rules_title": "=== Manage Monitor Rules ===",
        "no_rules": "(No rules currently)",
        "input_delete_indices": "Enter to delete (e.g. 0, 2), modify (e.g. m 1), or -1 to return: ",
        
        "menu_settings_title": "=== System Settings v{version} ===",
        "not_set": "Not Set",
        "settings_1": "1. Change API Settings (URL, Key, Secret)",
        "settings_2": "2. Change Alert Channels & Languages",
        "settings_3": "3. SSL Certificate Verification (Current: {status})",
        "settings_4": "4. SMTP Settings",
        "ssl_verify": "Verify",
        "ssl_ignore": "Ignore",
        "ssl_status_on": "\033[92mON\033[0m",
        "ssl_status_off": "\033[91mOFF\033[0m",
        "change_verify_to": "Change to? (1. Verify, 2. Ignore)",
        
        "settings_alert_title": "=== Alert & Language Settings ===",
        "change_language": "1. Change Language (Current: {lang})",
        "select_language": "Select Language (1. English, 2. ç¹é«”ä¸­æ–‡)",
        "toggle_mail_alert": "2. Toggle Mail Alert (Current: {status})",
        "toggle_line_alert": "3. Toggle LINE Alert (Current: {status})",
        "toggle_webhook_alert": "4. Toggle Webhook Alert (Current: {status})",
        "edit_line_channel_access_token": "5. Edit LINE Channel Access Token",
        "edit_line_target_id": "6. Edit LINE Target ID",
        "edit_webhook_url": "7. Edit Webhook URL",
        "line_token_input": "LINE Channel Token",
        "line_target_id_input": "LINE Target ID",
        "webhook_url_input": "Webhook URL",
        
        "smtp_title": "=== SMTP Settings ===",
        "enable_starttls": "Enable STARTTLS (Y/N/Enter)? [{status}]",
        "enable_auth": "Enable Auth (Y/N/Enter)? [{status}]",
        
        "warning_best_practices": "Warning: This action will clear all existing rules and load official recommended settings.",
        "confirm_continue": "Are you sure you want to continue? (Enter 'YES' to confirm)",
        
        # Debug & Analysis
        "checking_health": "Checking PCE Health...",
        "checking_events": "Checking Events...",
        "found_events": "  Found {count} events.",
        "processed_traffic_records": "  Processed {count} traffic records.",
        "trigger_alert": ">>> Trigger Alert: {name}",
        "rule_cooldown": "Rule {name} triggered but in cooldown.",
        
        "debug_mode_title": "=== Traffic Rule Simulation & Debug Mode ===",
        "query_past_mins": "Query data from past how many minutes? [Default: Auto-detect based on max rule window]",
        "submitting_query": "Submitting traffic query ({start} to {end})...",
        "simulation_report": "=== Simulation Report ===",
        "fetched_records": "Fetched {count} traffic records (Window: {mins} mins).",
        "rule_header": "Rule: {name} ({type})",
        "time_filter_results": "  -> [Time Filter] Original: {total} -> Rule Window({win}m): Remaining {rem} records",
        "calc_max_bw": "  -> Calculated Max Bandwidth: {val:.4} Mbps",
        "calc_sum_vol": "  -> Calculated Total Volume: {val:.4f} MB",
        "calc_sum_count": "  -> Calculated Total Count: {val:d}",
        "eval_result": "  -> Evaluation: {status} (Threshold: {threshold})",
        "samples_top10": "  -> Samples (Top 10):",
        "would_trigger": "ðŸ”´ WOULD TRIGGER",
        "pass": "ðŸŸ¢ PASS",
        
        # Mail/Reporter HTML UI
        "no_recipients": "Recipients empty, skipping Mail alert.",
        "mail_sent": "Email Sent via {host}:{port}.",
        "mail_failed": "Email Failed: {error}",
        "mail_subject": "[Illumio] Alert: {count} Issues",
        "mail_subject_test": "[Illumio] Test Email",
        "report_header": "Illumio PCE Monitor Report",
        "generated_at": "Generated at: {time}",
        "health_alerts_header": "ðŸš¨ System Health Alerts",
        "health_time": "Time",
        "health_status": "Status",
        "health_details": "Details",
        "security_events_header": "âš ï¸ Security Events",
        "event_time": "Time",
        "event_name": "Event",
        "event_severity": "Severity",
        "event_source": "Source",
        "traffic_alerts_header": "ðŸ›¡ï¸ Traffic Block Alerts",
        "traffic_rule": "Rule Name",
        "traffic_count": "Count",
        "traffic_criteria": "Criteria",
        "traffic_toptalkers": "Top Talkers",
        "metric_alerts_header": "ðŸ“Š Performance & Volume Alerts",
        "raw_snapshot": "Raw Snapshot:",
        "table_value": "Value",
        "table_first_seen": "First Seen",
        "table_last_seen": "Last Seen",
        "table_dir": "Dir",
        "table_source": "Source",
        "table_destination": "Destination",
        "table_service": "Service",
        "table_num_conns": "Num Conns",
        "table_decision": "Decision",
        "decision_blocked": "\033[91mBlocked\033[0m",
        "decision_potential": "\033[93mPotential\033[0m",
        "decision_allowed": "\033[92mAllowed\033[0m",
        
        # Alerters
        "line_alert_sent": "LINE Alert Sent.",
        "line_alert_failed": "LINE Alert Failed: {error} / {status}",
        "line_config_missing": "LINE Channel Token or Target ID not set. Skipping LINE alert.",
        "webhook_alert_sent": "Webhook Alert Sent.",
        "webhook_alert_failed": "Webhook Alert Failed: {error} / {status}",
        "webhook_url_missing": "Webhook URL not set. Skipping Webhook alert."
    },
    "zh_TW": {
        # General & Errors
        "error_loading_config": "è®€å–è¨­å®šå¤±æ•—: {error}",
        "config_saved": "è¨­å®šå·²å„²å­˜ã€‚",
        "error_saving_config": "å„²å­˜è¨­å®šå¤±æ•—: {error}",
        "warning_best_practices": "è­¦å‘Š: æ­¤æ“ä½œå°‡æ¸…é™¤æ‰€æœ‰ç¾æœ‰çš„è¦å‰‡ï¼Œä¸¦è¼‰å…¥å®˜æ–¹æŽ¨è–¦çš„æœ€ä½³å¯¦è¸è¨­å®šã€‚",
        "confirm_continue": "æ‚¨ç¢ºå®šè¦ç¹¼çºŒæ“ä½œå—Žï¼Ÿ",
        "best_practice_loaded": "\næœ€ä½³å¯¦è¸å·²æˆåŠŸè¼‰å…¥ï¼æŒ‰ Enter ç¹¼çºŒ...",
        "loading_best_practices": "æ­£åœ¨è¼‰å…¥æœ€ä½³å¯¦è¸ (æœƒæ¸…ç©ºç¾æœ‰è¦å‰‡)...",
        "press_enter_to_continue": "æŒ‰ Enter ç¹¼çºŒ...",
        "operation_cancelled": "\næ“ä½œå·²å–æ¶ˆã€‚æŒ‰ Enter ç¹¼çºŒ...",
        "done": "å®Œæˆã€‚",
        "bye": "å†è¦‹ã€‚",
        
        # Menu Titles
        "main_menu_title": "=== Illumio PCE Monitor ===",
        "main_menu_api": "API: {url} | è¦å‰‡æ•¸: {count}",
        "main_menu_1": "1. æ–°å¢žäº‹ä»¶è¦å‰‡ (å« PCE Health Check)",
        "main_menu_2": "2. æ–°å¢žæµé‡è¦å‰‡ (Traffic Rule)",
        "main_menu_3": "3. æ–°å¢žé »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡ (Bandwidth & Volume)",
        "main_menu_4": "4. ç®¡ç†è¦å‰‡ (åˆ—è¡¨/åˆªé™¤)",
        "main_menu_5": "5. ç³»çµ±è¨­å®š (API / å‘Šè­¦é€šé“ / Email)",
        "main_menu_6": "6. è¼‰å…¥å®˜æ–¹æœ€ä½³å¯¦è¸ (Best Practices)",
        "main_menu_7": "7. ç™¼é€æ¸¬è©¦å‘Šè­¦",
        "main_menu_8": "8. ç«‹å³åŸ·è¡Œç›£æŽ§ (Run Once)",
        "main_menu_9": "9. æµé‡è¦å‰‡æ¨¡æ“¬èˆ‡é™¤éŒ¯ (Debug Mode)",
        "main_menu_10": "10. å•Ÿå‹• Web GUI (ç¶²é ç®¡ç†ä»‹é¢)",
        "main_menu_0": "0. é›¢é–‹",
        "please_select": "è«‹é¸æ“‡",
        "starting_web_gui": "æ­£åœ¨å•Ÿå‹• Web GUI æ–¼",
        
        # Add Rules Menus
        "menu_add_event_title": "=== æ–°å¢žäº‹ä»¶ç›£æŽ§è¦å‰‡ ===",
        "menu_return": "0. è¿”å›žä¸Šå±¤",
        "menu_cancel": "0. å–æ¶ˆ",
        "set_health_check": "H. è¨­å®š PCE Health Check (ç›®å‰: {status})",
        "select_category": "è«‹é¸æ“‡é¡žåˆ¥ (è¼¸å…¥æ•¸å­—ï¼ŒH è¨­å®šå¥æª¢ï¼Œ0 è¿”å›ž): ",
        "select_event": "é¸æ“‡äº‹ä»¶",
        "rule_trigger_type_1": "1. ç«‹å³å‘Šè­¦",
        "rule_trigger_type_2": "2. ç´¯ç©æ¬¡æ•¸",
        "cumulative_count": "ç´¯ç©æ¬¡æ•¸",
        "hint_example_5": "ä¾‹: 5",
        "time_window_mins": "æ™‚é–“çª—å£(åˆ†)",
        "hint_example_10": "ä¾‹: 10",
        "cooldown_mins_default": "å†·å»æ™‚é–“ (åˆ†é˜) [é è¨­: {win}]",
        "rule_saved": "è¦å‰‡å·²å„²å­˜ã€‚æŒ‰ Enter ç¹¼çºŒ...",
        
        "menu_add_traffic_title": "=== æ–°å¢žæµé‡è¦å‰‡ (Traffic Rule - Blocked/Potential) ===",
        "rule_name": "è¦å‰‡åç¨± (ä¾‹å¦‚: Blocked SSH)",
        "policy_decision": "Policy Decision:",
        "pd_1": "1. \033[91mBlocked (é˜»æ“‹)\033[0m",
        "pd_2": "2. \033[93mPotential (æ½›åœ¨é˜»æ“‹)\033[0m",
        "pd_3": "3. \033[92mAllowed (å…è¨±)\033[0m",
        "pd_4": "4. All (å…¨éƒ¨)",
        "pd_select_default": "é¸æ“‡ [é è¨­: 1]",
        "advanced_filters": "--- é€²éšŽéŽæ¿¾ (Advanced Filters) ---",
        "port_input": "Port (ä¾‹å¦‚: 80, 443) [æŒ‰ Enter è·³éŽ]",
        "proto_select": "å”å®š (1. TCP, 2. UDP, 0. Both) [é è¨­: Both]",
        "src_input": "ä¾†æºæ¨™ç±¤/IP/CIDR (ä¾‹: role=Web, 10.0.0.0/8, 192.168.1.1) [æŒ‰ Enter è·³éŽ]",
        "dst_input": "ç›®çš„æ¨™ç±¤/IP/CIDR (ä¾‹: app=DB, 10.1.1.0/24, 192.168.1.5) [æŒ‰ Enter è·³éŽ]",
        "trigger_threshold_count": "è§¸ç™¼é–¾å€¼ (æ¬¡æ•¸) [é è¨­: 10]",
        "excludes_optional": "--- æŽ’é™¤æ¢ä»¶ (Excludes) - é¸å¡« ---",
        "ex_port_input": "æŽ’é™¤ Port (ä¾‹å¦‚: 22) [æŒ‰ Enter è·³éŽ]",
        "ex_src_input": "æŽ’é™¤ä¾†æºæ¨™ç±¤/IP/CIDR (ä¾‹: env=Kube, 10.9.9.9) [æŒ‰ Enter è·³éŽ]",
        "ex_dst_input": "æŽ’é™¤ç›®çš„æ¨™ç±¤/IP/CIDR (ä¾‹: 8.8.8.8) [æŒ‰ Enter è·³éŽ]",
        "traffic_rule_saved": "æµé‡è¦å‰‡å·²æ–°å¢žã€‚æŒ‰ Enter ç¹¼çºŒ...",
        
        "menu_add_bw_vol_title": "=== æ–°å¢žé »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡ (Bandwidth & Volume) ===",
        "rule_name_bw": "è¦å‰‡åç¨± (ä¾‹å¦‚: Database Spike)",
        "step_1_metric": "--- 1. é¸æ“‡ç›£æŽ§æŒ‡æ¨™ (Metric) ---",
        "metric_1": "1. é »å¯¬ (Bandwidth) - é©ç”¨: å‚³è¼¸é€ŸçŽ‡ (Mbps)",
        "metric_2": "2. å‚³è¼¸é‡ (Total Volume) - é©ç”¨: è³‡æ–™å¤–æ´© (MB/GB)",
        "step_2_filters": "--- 2. éŽæ¿¾æ¢ä»¶ (Filters) ---",
        "step_3_threshold": "--- 3. é–¾å€¼è¨­å®š (Threshold) ---",
        "trigger_threshold_unit": "è§¸ç™¼é–¾å€¼ ({unit})",
        "time_window_mins_default_5": "æ™‚é–“çª—å£ (åˆ†é˜) [é è¨­: 5]",
        
        "menu_manage_rules_title": "=== ç®¡ç†ç›£æŽ§è¦å‰‡ ===",
        "no_rules": "(ç›®å‰æ²’æœ‰è¦å‰‡)",
        "input_delete_indices": "è¼¸å…¥ç·¨è™Ÿåˆªé™¤ (å¦‚ 0, 2)ã€ä¿®æ”¹ (å¦‚ m 1) æˆ– -1 è¿”å›ž: ",
        
        "menu_settings_title": "=== ç³»çµ±è¨­å®š (System Settings) v{version} ===",
        "not_set": "æœªè¨­å®š",
        "settings_1": "1. ä¿®æ”¹ API è¨­å®š (URL, Key, Secret)",
        "settings_2": "2. å‘Šè­¦é€šé“èˆ‡èªžè¨€è¨­å®š (Alert Channels & Languages)",
        "settings_3": "3. SSL æ†‘è­‰é©—è­‰ (ç›®å‰: {status})",
        "settings_4": "4. SMTP è¨­å®š",
        "ssl_verify": "é©—è­‰ (Verify)",
        "ssl_ignore": "å¿½ç•¥ (Ignore)",
        "ssl_status_on": "\033[92mé–‹å•Ÿ\033[0m",
        "ssl_status_off": "\033[91mé—œé–‰\033[0m",
        "change_verify_to": "è®Šæ›´ç‚º? (1. é–‹å•Ÿ Verify, 2. é—œé–‰ Ignore)",
        
        "settings_alert_title": "=== å‘Šè­¦é€šé“èˆ‡èªžè¨€è¨­å®š ===",
        "change_language": "1. æ›´æ”¹èªžè¨€ (ç›®å‰: {lang})",
        "select_language": "é¸æ“‡èªžè¨€ (1. English, 2. ç¹é«”ä¸­æ–‡)",
        "toggle_mail_alert": "2. é–‹é—œ Mail å‘Šè­¦ (ç›®å‰: {status})",
        "toggle_line_alert": "3. é–‹é—œ LINE å‘Šè­¦ (ç›®å‰: {status})",
        "toggle_webhook_alert": "4. é–‹é—œ Webhook å‘Šè­¦ (ç›®å‰: {status})",
        "edit_line_channel_access_token": "5. ä¿®æ”¹ LINE Channel Access Token",
        "edit_line_target_id": "6. ä¿®æ”¹ LINE Target ID",
        "edit_webhook_url": "7. ä¿®æ”¹ Webhook URL",
        "line_token_input": "LINE Channel Token",
        "line_target_id_input": "LINE Target ID",
        "webhook_url_input": "Webhook URL",

        "smtp_title": "=== SMTP è¨­å®š ===",
        "enable_starttls": "å•Ÿç”¨ STARTTLS (Y/N/Enter)? [{status}]",
        "enable_auth": "å•Ÿç”¨é©—è­‰ (Y/N/Enter)? [{status}]",
        
        "warning_best_practices": "è­¦å‘Š: æ­¤æ“ä½œå°‡æ¸…é™¤æ‰€æœ‰ç¾æœ‰è¦å‰‡ä¸¦è¼‰å…¥å®˜æ–¹å»ºè­°è¨­å®šã€‚",
        "confirm_continue": "ç¢ºå®šè¦ç¹¼çºŒå—Ž? (è¼¸å…¥ 'YES' ç¢ºèª)",
        
        # Debug & Analysis
        "checking_health": "æª¢æŸ¥ PCE å¥åº·ç‹€æ…‹...",
        "checking_events": "æª¢æŸ¥äº‹ä»¶ (Events)...",
        "found_events": "  ç™¼ç¾ {count} å€‹äº‹ä»¶ã€‚",
        "processed_traffic_records": "  è™•ç†äº† {count} ç­†æµé‡ç´€éŒ„ã€‚",
        "trigger_alert": ">>> è§¸ç™¼å‘Šè­¦: {name}",
        "rule_cooldown": "è¦å‰‡ {name} å·²è§¸ç™¼ä½†è™•æ–¼å†·å»æ™‚é–“ä¸­ã€‚",
        
        "debug_mode_title": "=== æµé‡è¦å‰‡æ¨¡æ“¬èˆ‡é™¤éŒ¯ (Debug Mode) ===",
        "query_past_mins": "æŸ¥è©¢éŽåŽ»å¹¾åˆ†é˜çš„è³‡æ–™? [é è¨­: è‡ªå‹•åµæ¸¬æœ€å¤§è¦å‰‡æ™‚é–“]",
        "submitting_query": "æ­£åœ¨æäº¤æµé‡æŸ¥è©¢ ({start} è‡³ {end})...",
        "simulation_report": "=== æ¨¡æ“¬çµæžœå ±å‘Š ===",
        "fetched_records": "å…±å–å¾— {count} ç­†æµé‡è³‡æ–™ (Window: {mins} mins)ã€‚",
        "rule_header": "è¦å‰‡: {name} ({type})",
        "time_filter_results": "  -> [æ™‚é–“éŽæ¿¾] åŽŸå§‹è³‡æ–™: {total} -> è¦å‰‡è¦–çª—({win}m): å‰©é¤˜ {rem} ç­†",
        "calc_max_bw": "  -> è¨ˆç®—æœ€å¤§é »å¯¬ (Max): {val:.4} Mbps",
        "calc_sum_vol": "  -> è¨ˆç®—ç¸½å‚³è¼¸é‡ (Sum): {val:.4f} MB",
        "calc_sum_count": "  -> è¨ˆç®—ç¸½æ¬¡æ•¸ (Sum): {val:d}",
        "eval_result": "  -> åˆ¤å®šçµæžœ: {status} (é–¾å€¼: {threshold})",
        "samples_top10": "  -> æ¨£æœ¬ (Top 10):",
        "would_trigger": "ðŸ”´ æœƒè§¸ç™¼ (WOULD TRIGGER)",
        "pass": "ðŸŸ¢ é€šéŽ (PASS)",
        
        # Mail/Reporter HTML UI
        "no_recipients": "æœªè¨­å®šæ”¶ä»¶äººï¼Œç•¥éŽç™¼ä¿¡ã€‚",
        "mail_sent": "Email å·²é€éŽ {host}:{port} ç™¼é€ã€‚",
        "mail_failed": "Email ç™¼é€å¤±æ•—: {error}",
        "mail_subject": "[Illumio] å‘Šè­¦: ç™¼ç¾ {count} å€‹å•é¡Œ",
        "mail_subject_test": "[Illumio] æ¸¬è©¦å‘Šè­¦ä¿¡ä»¶",
        "report_header": "Illumio PCE Monitor ç›£æŽ§å ±å‘Š",
        "generated_at": "ç”¢ç”Ÿæ™‚é–“: {time}",
        "health_alerts_header": "ðŸš¨ ç³»çµ±å¥åº·ç‹€æ…‹å‘Šè­¦",
        "health_time": "æ™‚é–“",
        "health_status": "ç‹€æ…‹",
        "health_details": "è©³ç´°å…§å®¹",
        "security_events_header": "âš ï¸ è³‡å®‰äº‹ä»¶å‘Šè­¦",
        "event_time": "æ™‚é–“",
        "event_name": "äº‹ä»¶",
        "event_severity": "åš´é‡ç´šåˆ¥",
        "event_source": "ä¾†æº",
        "traffic_alerts_header": "ðŸ›¡ï¸ æµé‡é˜»æ“‹å‘Šè­¦",
        "traffic_rule": "è¦å‰‡åç¨±",
        "traffic_count": "æ¬¡æ•¸",
        "traffic_criteria": "è§¸ç™¼æ¢ä»¶",
        "traffic_toptalkers": "Top Talkers (å‰åå)",
        "metric_alerts_header": "ðŸ“Š æ•ˆèƒ½èˆ‡å‚³è¼¸é‡å‘Šè­¦",
        "raw_snapshot": "åŽŸå§‹å¿«ç…§:",
        "table_value": "æ¸¬é‡å€¼",
        "table_first_seen": "é¦–æ¬¡ç™¼ç¾",
        "table_last_seen": "æœ€å¾Œç™¼ç¾",
        "table_dir": "æ–¹å‘",
        "table_source": "ä¾†æº (Source)",
        "table_destination": "ç›®çš„ (Destination)",
        "table_service": "æœå‹™",
        "table_num_conns": "é€£ç·šæ•¸",
        "table_decision": "ç­–ç•¥",
        "decision_blocked": "\033[91må·²é˜»æ“‹\033[0m",
        "decision_potential": "\033[93mæ½›åœ¨é˜»æ“‹\033[0m",
        "decision_allowed": "\033[92må…è¨±\033[0m",

        # Alerters
        "line_alert_sent": "LINE å‘Šè­¦å·²é€å‡ºã€‚",
        "line_alert_failed": "LINE å‘Šè­¦å¤±æ•—: {error} / {status}",
        "line_config_missing": "æœªè¨­å®š LINE Token æˆ– Target IDï¼Œç•¥éŽ LINE å‘Šè­¦ã€‚",
        "webhook_alert_sent": "Webhook å‘Šè­¦å·²é€å‡ºã€‚",
        "webhook_alert_failed": "Webhook å‘Šè­¦å¤±æ•—: {error} / {status}",
        "webhook_url_missing": "æœªè¨­å®š Webhook URLï¼Œç•¥éŽ Webhook å‘Šè­¦ã€‚"
    }
}

def t(key: str, **kwargs) -> str:
    """Translates a key into the currently selected language."""
    text = MESSAGES.get(_current_lang, MESSAGES["en"]).get(key, key)
    
    if kwargs:
        try:
            return text.format(**kwargs)
        except Exception:
            return text
    return text
