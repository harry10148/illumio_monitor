import locale
_current_lang = "en"

def set_language(lang: str):
    global _current_lang
    if lang in ["en", "zh_TW"]:
        _current_lang = lang

def get_language() -> str:
    return _current_lang

MESSAGES = {
    "en": {
        # General & Errors
        "error_loading_config": "Error loading config: {error}",
        "config_saved": "Configuration saved.",
        "error_saving_config": "Error saving config: {error}",
        "rule_overwritten": "Rule already exists, updated configuration.",
        "rule_deleted": "Deleted: {name}",
        "loading_best_practices": "Loading Best Practices (will clear existing rules)...",
        "press_enter_to_continue": "Press Enter to continue...",
        "operation_cancelled": "Operation cancelled.",
        "done": "Done.",
        "bye": "Bye.",
        
        # Menu Titles
        "main_menu_title": "=== Illumio PCE Monitor ===",
        "main_menu_api": "API: {url} | Rules: {count}",
        "main_menu_1": "1. Add Event Rule (inc. PCE Health Check)",
        "main_menu_2": "2. Add Traffic Rule",
        "main_menu_3": "3. Add Bandwidth & Volume Rule",
        "main_menu_4": "4. Manage Rules (List/Delete)",
        "main_menu_5": "5. System Settings (API / Email / Alerts)",
        "main_menu_6": "6. Load Official Best Practices",
        "main_menu_7": "7. Send Test Alert",
        "main_menu_8": "8. Run Monitor Once",
        "main_menu_9": "9. Traffic Rule Debug Mode",
        "main_menu_10": "10. Launch Web GUI",
        "main_menu_0": "0. Exit",
        "please_select": "Please select",
        "starting_web_gui": "Starting Web GUI at",
        
        # Add Rules Menus
        "menu_add_event_title": "=== Add Event Monitor Rule ===",
        "menu_return": "0. Return",
        "menu_cancel": "0. Cancel",
        "set_health_check": "H. Toggle PCE Health Check (Current: {status})",
        "select_category": "Select category (Number, H for Health Check, 0 to return): ",
        "select_event": "Select Event",
        "rule_trigger_type_1": "1. Immediate Alert",
        "rule_trigger_type_2": "2. Cumulative Count",
        "cumulative_count": "Cumulative Count",
        "hint_example_5": "e.g.: 5",
        "time_window_mins": "Time Window (mins)",
        "hint_example_10": "e.g.: 10",
        "cooldown_mins_default": "Cooldown Time (mins) [Default: {win}]",
        "rule_saved": "Rule saved. Press Enter to continue...",
        
        "menu_add_traffic_title": "=== Add Traffic Rule (Blocked/Potential) ===",
        "rule_name": "Rule Name (e.g.: Blocked SSH)",
        "policy_decision": "Policy Decision:",
        "pd_1": "1. \033[91mBlocked\033[0m",
        "pd_2": "2. \033[93mPotential\033[0m",
        "pd_3": "3. \033[92mAllowed\033[0m",
        "pd_4": "4. All",
        "pd_select_default": "Select [Default: 1]",
        "advanced_filters": "--- Advanced Filters ---",
        "port_input": "Port (e.g., 80, 443) [Press Enter to skip]",
        "proto_select": "Protocol (1. TCP, 2. UDP, 0. Both) [Default: Both]",
        "src_input": "Source Label/IP/CIDR (e.g., role=Web, 10.0.0.0/8, 192.168.1.1) [Press Enter to skip]",
        "dst_input": "Dest Label/IP/CIDR (e.g., app=DB, 10.1.1.0/24, 192.168.1.5) [Press Enter to skip]",
        "trigger_threshold_count": "Trigger Threshold (count) [Default: 10]",
        "excludes_optional": "--- Excludes (Optional) ---",
        "ex_port_input": "Exclude Port (e.g., 22) [Press Enter to skip]",
        "ex_src_input": "Exclude Source Label/IP/CIDR (e.g., env=Kube, 10.9.9.9) [Press Enter to skip]",
        "ex_dst_input": "Exclude Dest Label/IP/CIDR (e.g., 8.8.8.8) [Press Enter to skip]",
        "traffic_rule_saved": "Traffic Rule added. Press Enter to continue...",
        
        "menu_add_bw_vol_title": "=== Add Bandwidth & Volume Rule ===",
        "rule_name_bw": "Rule Name (e.g.: Database Spike)",
        "step_1_metric": "--- 1. Select Metric ---",
        "metric_1": "1. Bandwidth - Applicable for transmission rate (Mbps)",
        "metric_2": "2. Total Volume - Applicable for data exfiltration (MB/GB)",
        "step_2_filters": "--- 2. Filters ---",
        "step_3_threshold": "--- 3. Threshold ---",
        "trigger_threshold_unit": "Trigger Threshold ({unit})",
        "time_window_mins_default_5": "Time Window (mins) [Default: 5]",
        
        "menu_manage_rules_title": "=== Manage Monitor Rules ===",
        "no_rules": "(No rules currently)",
        "input_delete_indices": "Enter to delete (e.g. 0, 2), modify (e.g. m 1), or -1 to return: ",
        
        "menu_settings_title": "=== System Settings v{version} ===",
        "not_set": "Not Set",
        "settings_1": "1. Change API Settings (URL, Key, Secret)",
        "settings_2": "2. Change Alert Channels & Languages",
        "settings_3": "3. SSL Certificate Verification (Current: {status})",
        "settings_4": "4. SMTP Settings",
        "ssl_verify": "Verify",
        "ssl_ignore": "Ignore",
        "ssl_status_on": "\033[92mON\033[0m",
        "ssl_status_off": "\033[91mOFF\033[0m",
        "change_verify_to": "Change to? (1. Verify, 2. Ignore)",
        
        "settings_alert_title": "=== Alert & Language Settings ===",
        "change_language": "1. Change Language (Current: {lang})",
        "select_language": "Select Language (1. English, 2. ç¹é«”ä¸­æ–‡)",
        "toggle_mail_alert": "2. Toggle Mail Alert (Current: {status})",
        "toggle_line_alert": "3. Toggle LINE Alert (Current: {status})",
        "toggle_webhook_alert": "4. Toggle Webhook Alert (Current: {status})",
        "edit_line_channel_access_token": "5. Edit LINE Channel Access Token",
        "edit_line_target_id": "6. Edit LINE Target ID",
        "edit_webhook_url": "7. Edit Webhook URL",
        "line_token_input": "LINE Channel Token",
        "line_target_id_input": "LINE Target ID",
        "webhook_url_input": "Webhook URL",
        
        "smtp_title": "=== SMTP Settings ===",
        "enable_starttls": "Enable STARTTLS (Y/N/Enter)? [{status}]",
        "enable_auth": "Enable Auth (Y/N/Enter)? [{status}]",
        
        "warning_best_practices": "Warning: This action will clear all existing rules and load official recommended settings.",
        "confirm_continue": "Are you sure you want to continue? (Enter 'YES' to confirm)",
        
        # Debug & Analysis
        "checking_health": "Checking PCE Health...",
        "checking_events": "Checking Events...",
        "found_events": "  Found {count} events.",
        "processed_traffic_records": "  Processed {count} traffic records.",
        "trigger_alert": ">>> Trigger Alert: {name}",
        "rule_cooldown": "Rule {name} triggered but in cooldown.",
        
        "debug_mode_title": "=== Traffic Rule Simulation & Debug Mode ===",
        "query_past_mins": "Query data from past how many minutes? [Default: Auto-detect based on max rule window]",
        "submitting_query": "Submitting traffic query ({start} to {end})...",
        "simulation_report": "=== Simulation Report ===",
        "fetched_records": "Fetched {count} traffic records (Window: {mins} mins).",
        "rule_header": "Rule: {name} ({type})",
        "time_filter_results": "  -> [Time Filter] Original: {total} -> Rule Window({win}m): Remaining {rem} records",
        "calc_max_bw": "  -> Calculated Max Bandwidth: {val:.4} Mbps",
        "calc_sum_vol": "  -> Calculated Total Volume: {val:.4f} MB",
        "calc_sum_count": "  -> Calculated Total Count: {val:d}",
        "eval_result": "  -> Evaluation: {status} (Threshold: {threshold})",
        "samples_top10": "  -> Samples (Top 10):",
        "would_trigger": "ðŸ”´ WOULD TRIGGER",
        "pass": "ðŸŸ¢ PASS",
        
        # Event Descriptions
        "event_agent_missed_heartbeats": "Missed Heartbeat",
        "event_agent_offline": "Agent Offline",
        "event_lost_agent_found": "Lost Agent Found",
        "event_service_not_available": "Agent Service Unavailable",
        "event_agent_goodbye": "Agent Goodbye",
        "event_agent_tampering": "Agent Tampering",
        "event_agent_suspend": "Agent Suspended",
        "event_agent_clone_detected": "Agent Clone Detected",
        "event_agent_activate": "Agent Paired",
        "event_agent_deactivate": "Agent Unpaired",
        "event_user_login_failed": "Login Failed",
        "event_user_sign_in": "User Sign In",
        "event_csrf_failed": "CSRF Validation Failed",
        "event_api_auth_failed": "API Auth Failed",
        "event_api_authz_failed": "API Authz Failed",
        "event_api_key_create": "Create API Key",
        "event_api_key_delete": "Delete API Key",
        "event_ruleset_delete": "Delete Rule Set",
        "event_ruleset_create": "Create Rule Set",
        "event_ruleset_update": "Update Rule Set",
        "event_rule_create": "Create Rule",
        "event_rule_delete": "Delete Rule",
        "event_policy_prov": "Policy Provisioning",
        "event_workload_create": "Create Workload",
        "event_workload_delete": "Delete Workload",
        "event_pce_start": "PCE Started",
        "event_cluster_update": "Cluster Update",
        
        "selected": "Selected",
        "setup_smtp": "=== SMTP Settings ===",
        
        # Mail/Reporter HTML UI
        "no_recipients": "Recipients empty, skipping Mail alert.",
        "mail_sent": "Email Sent via {host}:{port}.",
        "mail_failed": "Email Failed: {error}",
        "mail_subject": "[Illumio] Alert: {count} Issues",
        "mail_subject_test": "[Illumio] Test Email",
        "report_header": "Illumio PCE Monitor Report",
        "generated_at": "Generated at: {time}",
        "health_alerts_header": "ðŸš¨ System Health Alerts",
        "health_time": "Time",
        "health_status": "Status",
        "health_details": "Details",
        "security_events_header": "âš ï¸ Security Events",
        "event_time": "Time",
        "event_name": "Event",
        "event_severity": "Severity",
        "event_source": "Source",
        "traffic_alerts_header": "ðŸ›¡ï¸ Traffic Block Alerts",
        "traffic_rule": "Rule Name",
        "traffic_count": "Count",
        "traffic_criteria": "Criteria",
        "traffic_toptalkers": "Top Talkers",
        "metric_alerts_header": "ðŸ“Š Performance & Volume Alerts",
        "raw_snapshot": "Raw Snapshot:",
        "table_value": "Value",
        "table_first_seen": "First Seen",
        "table_last_seen": "Last Seen",
        "table_dir": "Dir",
        "table_source": "Source",
        "table_destination": "Destination",
        "table_service": "Service",
        "table_num_conns": "Num Conns",
        "table_decision": "Decision",
        "decision_blocked": "\033[91mBlocked\033[0m",
        "decision_potential": "\033[93mPotential\033[0m",
        "decision_allowed": "\033[92mAllowed\033[0m",
        
        # Alerters
        "line_alert_sent": "LINE Alert Sent.",
        "line_alert_failed": "LINE Alert Failed: {error} / {status}",
        "line_config_missing": "LINE Channel Token or Target ID not set. Skipping LINE alert.",
        "webhook_alert_sent": "Webhook Alert Sent.",
        "webhook_alert_failed": "Webhook Alert Failed: {error} / {status}",
        "webhook_url_missing": "Webhook URL not set. Skipping Webhook alert.",

        # Web GUI
        "gui_title": "Illumio PCE Monitor",
        "gui_stop": "Stop",
        "gui_tab_dashboard": "Dashboard",
        "gui_tab_rules": "Rules",
        "gui_tab_settings": "Settings",
        "gui_tab_actions": "Actions",
        "gui_api_status": "API Status",
        "gui_active_rules": "Active Rules",
        "gui_health_check": "Health Check",
        "gui_language": "Language",
        "gui_test_conn": "Test Connection",
        "gui_refresh": "Refresh",
        "gui_param_guide": "Parameter Guide",
        "gui_add_event": "+ Event",
        "gui_add_traffic": "+ Traffic",
        "gui_add_bw": "+ BW/Vol",
        "gui_delete": "Delete",
        "gui_col_type": "Type",
        "gui_col_name": "Name",
        "gui_col_status": "Status",
        "gui_col_condition": "Condition",
        "gui_col_filters": "Filters",
        "gui_col_edit": "Edit",
        "gui_save_all": "Save All Settings",
        "gui_run_once": "Run Monitor Once",
        "gui_run_once_desc": "Execute full cycle: Health â†’ Fetch â†’ Analyze â†’ Alert",
        "gui_run_btn": "Run",
        "gui_debug_mode": "Debug Mode",
        "gui_debug_desc": "Sandbox mode â€” no alerts, no state updates",
        "gui_window_min": "Window (min)",
        "gui_policy_dec": "Policy Dec.",
        "gui_pd_blocked": "Blocked",
        "gui_pd_allowed": "Allowed",
        "gui_pd_all": "All",
        "gui_pd_potential": "Potential",
        "gui_run_debug": "Run Debug",
        "gui_test_alert": "Send Test Alert",
        "gui_test_alert_desc": "Verify Email / LINE / Webhook delivery",
        "gui_send": "Send",
        "gui_ta_query": "Traffic Analysis Query",
        "gui_window": "Window",
        "gui_filter_details": "Filter Details",
        "gui_quick_search_placeholder": "Quick Search String...",
        "gui_sort_by": "Sort By",
        "gui_filter_settings": "Filter Settings",
        "gui_query_flow": "Query Flow",
        "gui_first_last_seen": "First/Last Seen",
        "gui_metric": "Metric",
        "gui_source_identity": "Source Identity",
        "gui_destination_identity": "Destination Identity",
        "gui_service_port": "Service",
        "gui_actions": "Actions",
        "gui_ws_search": "Advanced Workload Search",
        "gui_win_15m": "Last 15m",
        "gui_win_1h": "Last 1 hr",
        "gui_win_24h": "Last 24 hr",
        "gui_win_1w": "Last 1 Week",
        "gui_win_1m": "Last 1 Month",
        "gui_traffic_analyzer": "Traffic Analyzer",
        "gui_workload_search": "Workload Search",
        "gui_top10_widgets": "Top 10 Widgets",
        "gui_workload_name": "Workload Name",
        "gui_ip_address": "IP Address",
        "gui_hostname": "Hostname",
        "gui_find": "Find",
        "gui_ws_empty": "Search by IP or Name to find workloads in the PCE.",
        "gui_ws_col_status": "Status / Name",
        "gui_ws_col_management": "Management",
        "gui_ws_col_ip": "IP & Interface",
        "gui_ws_col_labels": "Active Labels",
        "gui_status_online": "Online",
        "gui_status_offline": "Offline",
        "gui_management_managed": "Managed",
        "gui_management_unmanaged": "Unmanaged",
        "gui_no_traffic": "No anomalous traffic found matching criteria.",
        "gui_flows": "flows",
        "gui_all_services": "All Services",
        "gui_pd_blocked": "Blocked",
        "gui_pd_potential": "Potential",
        "gui_pd_allowed": "Allowed",
        "gui_pd_all": "All",
        "gui_total_found_ws": "Total {count} workloads",
        "gui_ta_guide_sec_search": "Filter Details / Quick Search",
        "gui_ta_guide_search_desc": "This field performs real-time matching on the returned results (supports top 500 records), matching:",
        "gui_ta_guide_li_proc": "Process Name (Process): e.g. sshd, nginx, java",
        "gui_ta_guide_li_user": "User Name (User): e.g. root, www-data, system",
        "gui_ta_guide_li_svc": "Service Name (Service): e.g. HTTPS, MySQL",
        "gui_ta_guide_li_wn": "Workload Name: e.g. web-server-01",
        "gui_ta_guide_li_ip": "IP Address: e.g. 10.0.0.1",
        "gui_ta_guide_li_port": "Port: e.g. 443",
        "gui_ta_guide_sec_adv": "Advanced Filter Settings",
        "gui_ta_guide_adv_desc": "These parameters are sent directly to the Illumio API for server-side filtering:",
        "gui_ta_guide_li_labels": "Labels: Use Key=Value format, e.g. role=Web",
        "gui_ta_guide_li_excludes": "Excludes: Exclude specific ports, labels, or IP ranges",
        "gui_ta_guide_li_pd": "Policy Decision: Filter by decisions (Blocked, Allowed, etc.)",
        "gui_rank_bw": "Max Bandwidth (Mbps)",
        "gui_rank_vol": "Total Volume (MB)",
        "gui_rank_conn": "Connection Count",
        "gui_top10_loading": "Loading...",
        "gui_top10_querying": "Querying...",
        "gui_top10_empty": "No data. Click Run to query.",
        "gui_page_size": "Page Size",
        "gui_prev": "Prev",
        "gui_next": "Next",
        "gui_total_found": "Total {count} records",
        "gui_ta_guide_title": "Traffic Analyzer Parameter Guide",
        "gui_ta_guide_desc": "Use 'Filter Details' to search for process names, users, or workload names.",
        "gui_best_practices": "Load Best Practices",
        "gui_best_practices_desc": "Replace ALL existing rules with recommended defaults",
        "gui_load": "Load",
        "gui_output": "Output",
        "gui_cancel": "Cancel",
        "gui_save": "Save",
        "gui_api_conn": "API Connection",
        "gui_url": "URL",
        "gui_org_id": "Org ID",
        "gui_api_key": "API Key",
        "gui_api_secret": "API Secret",
        "gui_verify_ssl": "Verify SSL",
        "gui_email_smtp": "Email & SMTP",
        "gui_sender": "Sender",
        "gui_recipients": "Recipients (comma)",
        "gui_smtp_host": "SMTP Host",
        "gui_port": "Port",
        "gui_user": "User",
        "gui_password": "Password",
        "gui_alert_channels": "Alert Channels",
        "gui_mail": "Mail",
        "gui_line": "LINE",
        "gui_webhook": "Webhook",
        "gui_line_token": "LINE Token",
        "gui_line_target_id": "LINE Target ID",
        "gui_webhook_url": "Webhook URL",
        "gui_lang_settings": "Display & General",
        "gui_lang_en": "English",
        "gui_lang_zh": "ç¹é«”ä¸­æ–‡",
        "gui_theme_dark": "Dark Theme",
        "gui_theme_light": "Light Theme",
        "gui_add_event_rule": "Add Event Rule",
        "gui_edit_event_rule": "Edit Event Rule",
        "gui_category": "Category",
        "gui_event_type": "Event Type",
        "gui_select": "Select...",
        "gui_select_first": "Select category first",
        "gui_threshold": "Threshold",
        "gui_type": "Type",
        "gui_tt_immediate": "Immediate",
        "gui_tt_count": "Cumulative",
        "gui_count": "Count",
        "gui_cooldown": "Cooldown (min)",
        "gui_enable_hc": "Enable PCE Health Check",
        "gui_add_traffic_rule": "Add Traffic Rule",
        "gui_edit_traffic_rule": "Edit Traffic Rule",
        "gui_rule_name": "Rule Name",
        "gui_protocol": "Protocol",
        "gui_both": "Both",
        "gui_tcp": "TCP",
        "gui_udp": "UDP",
        "gui_source": "Source (Label/IP)",
        "gui_dest": "Destination (Label/IP)",
        "gui_excludes": "Excludes (Optional)",
        "gui_ex_port": "Exclude Port",
        "gui_ex_src": "Exclude Source",
        "gui_run_all_queries": "Run All Queries",
        "gui_add_query_widget": "Add Query Widget",
        "gui_query_widget_name": "Widget Name",
        "gui_ex_dest": "Exclude Destination",
        "gui_add_bw_rule": "Add Bandwidth / Volume Rule",
        "gui_edit_bw_rule": "Edit Bandwidth / Volume Rule",
        "gui_metric_type": "Metric Type",
        "gui_mt_bw": "Bandwidth (Mbps, Max)",
        "gui_mt_vol": "Volume (MB, Sum)",
        "gui_value": "Value",
        "gui_top10_title": "Top 10 Query Report",
        "gui_rank_by": "Rank By",
        "gui_rank_count": "Connection Count",
        "gui_rank_volume": "Total Volume (MB)",
        "gui_rank_bw": "Max Bandwidth (Mbps)",
        "gui_top10_flow": "Source -> Destination [Port]",
        "gui_top10_empty": "No data. Click Run to query.",
        "gui_top10_querying": "Querying...",
        "gui_top10_loading": "Loading...",
        "gui_top10_found": "Found {count} records. (Showing Top 10)",
        "gui_top10_no_records": "No records found.",
        "gui_top10_error": "Error querying data.",
        "gui_cooldown_title": "Rules in Cooldown",
        "gui_cooldown_remaining": "{mins}m remaining",
        "gui_cooldown_active": "Cooldown",
        "gui_cooldown_ready": "Ready"
    },
    "zh_TW": {
        # General & Errors
        "error_loading_config": "è®€å–è¨­å®šå¤±æ•—: {error}",
        "config_saved": "è¨­å®šå·²å„²å­˜ã€‚",
        "error_saving_config": "å„²å­˜è¨­å®šå¤±æ•—: {error}",
        "warning_best_practices": "è­¦å‘Š: æ­¤æ“ä½œå°‡æ¸…é™¤æ‰€æœ‰ç¾æœ‰çš„è¦å‰‡ï¼Œä¸¦è¼‰å…¥å®˜æ–¹æŽ¨è–¦çš„æœ€ä½³å¯¦è¸è¨­å®šã€‚",
        "confirm_continue": "æ‚¨ç¢ºå®šè¦ç¹¼çºŒæ“ä½œå—Žï¼Ÿ",
        "best_practice_loaded": "\næœ€ä½³å¯¦è¸å·²æˆåŠŸè¼‰å…¥ï¼æŒ‰ Enter ç¹¼çºŒ...",
        "loading_best_practices": "æ­£åœ¨è¼‰å…¥æœ€ä½³å¯¦è¸ (æœƒæ¸…ç©ºç¾æœ‰è¦å‰‡)...",
        "press_enter_to_continue": "æŒ‰ Enter ç¹¼çºŒ...",
        "operation_cancelled": "\næ“ä½œå·²å–æ¶ˆã€‚æŒ‰ Enter ç¹¼çºŒ...",
        "done": "å®Œæˆã€‚",
        "bye": "å†è¦‹ã€‚",
        
        # Menu Titles
        "main_menu_title": "=== Illumio PCE Monitor ===",
        "main_menu_api": "API: {url} | è¦å‰‡æ•¸: {count}",
        "main_menu_1": "1. æ–°å¢žäº‹ä»¶è¦å‰‡ (å« PCE Health Check)",
        "main_menu_2": "2. æ–°å¢žæµé‡è¦å‰‡ (Traffic Rule)",
        "main_menu_3": "3. æ–°å¢žé »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡ (Bandwidth & Volume)",
        "main_menu_4": "4. ç®¡ç†è¦å‰‡ (åˆ—è¡¨/åˆªé™¤)",
        "main_menu_5": "5. ç³»çµ±è¨­å®š (API / å‘Šè­¦é€šé“ / Email)",
        "main_menu_6": "6. è¼‰å…¥å®˜æ–¹æœ€ä½³å¯¦è¸ (Best Practices)",
        "main_menu_7": "7. ç™¼é€æ¸¬è©¦å‘Šè­¦",
        "main_menu_8": "8. ç«‹å³åŸ·è¡Œç›£æŽ§ (Run Once)",
        "main_menu_9": "9. æµé‡è¦å‰‡æ¨¡æ“¬èˆ‡é™¤éŒ¯ (Debug Mode)",
        "main_menu_10": "10. å•Ÿå‹• Web GUI (ç¶²é ç®¡ç†ä»‹é¢)",
        "main_menu_0": "0. é›¢é–‹",
        "please_select": "è«‹é¸æ“‡",
        "starting_web_gui": "æ­£åœ¨å•Ÿå‹• Web GUI æ–¼",
        
        # Add Rules Menus
        "menu_add_event_title": "=== æ–°å¢žäº‹ä»¶ç›£æŽ§è¦å‰‡ ===",
        "menu_return": "0. è¿”å›žä¸Šå±¤",
        "menu_cancel": "0. å–æ¶ˆ",
        "set_health_check": "H. è¨­å®š PCE Health Check (ç›®å‰: {status})",
        "select_category": "è«‹é¸æ“‡é¡žåˆ¥ (è¼¸å…¥æ•¸å­—ï¼ŒH è¨­å®šå¥æª¢ï¼Œ0 è¿”å›ž): ",
        "select_event": "é¸æ“‡äº‹ä»¶",
        "rule_trigger_type_1": "1. ç«‹å³å‘Šè­¦",
        "rule_trigger_type_2": "2. ç´¯ç©æ¬¡æ•¸",
        "cumulative_count": "ç´¯ç©æ¬¡æ•¸",
        "hint_example_5": "ä¾‹: 5",
        "time_window_mins": "æ™‚é–“çª—å£(åˆ†)",
        "hint_example_10": "ä¾‹: 10",
        "cooldown_mins_default": "å†·å»æ™‚é–“ (åˆ†é˜) [é è¨­: {win}]",
        "rule_saved": "è¦å‰‡å·²å„²å­˜ã€‚æŒ‰ Enter ç¹¼çºŒ...",
        
        "menu_add_traffic_title": "=== æ–°å¢žæµé‡è¦å‰‡ (Traffic Rule - Blocked/Potential) ===",
        "rule_name": "è¦å‰‡åç¨± (ä¾‹å¦‚: Blocked SSH)",
        "policy_decision": "Policy Decision:",
        "pd_1": "1. \033[91mBlocked (é˜»æ“‹)\033[0m",
        "pd_2": "2. \033[93mPotential (æ½›åœ¨é˜»æ“‹)\033[0m",
        "pd_3": "3. \033[92mAllowed (å…è¨±)\033[0m",
        "pd_4": "4. All (å…¨éƒ¨)",
        "pd_select_default": "é¸æ“‡ [é è¨­: 1]",
        "advanced_filters": "--- é€²éšŽéŽæ¿¾ (Advanced Filters) ---",
        "port_input": "Port (ä¾‹å¦‚: 80, 443) [æŒ‰ Enter è·³éŽ]",
        "proto_select": "å”å®š (1. TCP, 2. UDP, 0. Both) [é è¨­: Both]",
        "src_input": "ä¾†æºæ¨™ç±¤/IP/CIDR (ä¾‹: role=Web, 10.0.0.0/8, 192.168.1.1) [æŒ‰ Enter è·³éŽ]",
        "dst_input": "ç›®çš„æ¨™ç±¤/IP/CIDR (ä¾‹: app=DB, 10.1.1.0/24, 192.168.1.5) [æŒ‰ Enter è·³éŽ]",
        "trigger_threshold_count": "è§¸ç™¼é–¾å€¼ (æ¬¡æ•¸) [é è¨­: 10]",
        "excludes_optional": "--- æŽ’é™¤æ¢ä»¶ (Excludes) - é¸å¡« ---",
        "ex_port_input": "æŽ’é™¤ Port (ä¾‹å¦‚: 22) [æŒ‰ Enter è·³éŽ]",
        "ex_src_input": "æŽ’é™¤ä¾†æºæ¨™ç±¤/IP/CIDR (ä¾‹: env=Kube, 10.9.9.9) [æŒ‰ Enter è·³éŽ]",
        "ex_dst_input": "æŽ’é™¤ç›®çš„æ¨™ç±¤/IP/CIDR (ä¾‹: 8.8.8.8) [æŒ‰ Enter è·³éŽ]",
        "traffic_rule_saved": "æµé‡è¦å‰‡å·²æ–°å¢žã€‚æŒ‰ Enter ç¹¼çºŒ...",
        
        "menu_add_bw_vol_title": "=== æ–°å¢žé »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡ (Bandwidth & Volume) ===",
        "rule_name_bw": "è¦å‰‡åç¨± (ä¾‹å¦‚: Database Spike)",
        "step_1_metric": "--- 1. é¸æ“‡ç›£æŽ§æŒ‡æ¨™ (Metric) ---",
        "metric_1": "1. é »å¯¬ (Bandwidth) - é©ç”¨: å‚³è¼¸é€ŸçŽ‡ (Mbps)",
        "metric_2": "2. å‚³è¼¸é‡ (Total Volume) - é©ç”¨: è³‡æ–™å¤–æ´© (MB/GB)",
        "step_2_filters": "--- 2. éŽæ¿¾æ¢ä»¶ (Filters) ---",
        "step_3_threshold": "--- 3. é–¾å€¼è¨­å®š (Threshold) ---",
        "trigger_threshold_unit": "è§¸ç™¼é–¾å€¼ ({unit})",
        "time_window_mins_default_5": "æ™‚é–“çª—å£ (åˆ†é˜) [é è¨­: 5]",
        
        "menu_manage_rules_title": "=== ç®¡ç†ç›£æŽ§è¦å‰‡ ===",
        "no_rules": "(ç›®å‰æ²’æœ‰è¦å‰‡)",
        "input_delete_indices": "è¼¸å…¥ç·¨è™Ÿåˆªé™¤ (å¦‚ 0, 2)ã€ä¿®æ”¹ (å¦‚ m 1) æˆ– -1 è¿”å›ž: ",
        
        "menu_settings_title": "=== ç³»çµ±è¨­å®š (System Settings) v{version} ===",
        "not_set": "æœªè¨­å®š",
        "settings_1": "1. ä¿®æ”¹ API è¨­å®š (URL, Key, Secret)",
        "settings_2": "2. å‘Šè­¦é€šé“èˆ‡èªžè¨€è¨­å®š (Alert Channels & Languages)",
        "settings_3": "3. SSL æ†‘è­‰é©—è­‰ (ç›®å‰: {status})",
        "settings_4": "4. SMTP è¨­å®š",
        "ssl_verify": "é©—è­‰ (Verify)",
        "ssl_ignore": "å¿½ç•¥ (Ignore)",
        "ssl_status_on": "\033[92mé–‹å•Ÿ\033[0m",
        "ssl_status_off": "\033[91mé—œé–‰\033[0m",
        "change_verify_to": "è®Šæ›´ç‚º? (1. é–‹å•Ÿ Verify, 2. é—œé–‰ Ignore)",
        
        "settings_alert_title": "=== å‘Šè­¦é€šé“èˆ‡èªžè¨€è¨­å®š ===",
        "change_language": "1. æ›´æ”¹èªžè¨€ (ç›®å‰: {lang})",
        "select_language": "é¸æ“‡èªžè¨€ (1. English, 2. ç¹é«”ä¸­æ–‡)",
        "toggle_mail_alert": "2. é–‹é—œ Mail å‘Šè­¦ (ç›®å‰: {status})",
        "toggle_line_alert": "3. é–‹é—œ LINE å‘Šè­¦ (ç›®å‰: {status})",
        "toggle_webhook_alert": "4. é–‹é—œ Webhook å‘Šè­¦ (ç›®å‰: {status})",
        "edit_line_channel_access_token": "5. ä¿®æ”¹ LINE Channel Access Token",
        "edit_line_target_id": "6. ä¿®æ”¹ LINE Target ID",
        "edit_webhook_url": "7. ä¿®æ”¹ Webhook URL",
        "line_token_input": "LINE Channel Token",
        "line_target_id_input": "LINE Target ID",
        "webhook_url_input": "Webhook URL",

        "smtp_title": "=== SMTP è¨­å®š ===",
        "enable_starttls": "å•Ÿç”¨ STARTTLS (Y/N/Enter)? [{status}]",
        "enable_auth": "å•Ÿç”¨é©—è­‰ (Y/N/Enter)? [{status}]",
        
        "warning_best_practices": "è­¦å‘Š: æ­¤æ“ä½œå°‡æ¸…é™¤æ‰€æœ‰ç¾æœ‰è¦å‰‡ä¸¦è¼‰å…¥å®˜æ–¹å»ºè­°è¨­å®šã€‚",
        "confirm_continue": "ç¢ºå®šè¦ç¹¼çºŒå—Ž? (è¼¸å…¥ 'YES' ç¢ºèª)",
        
        # Debug & Analysis
        "checking_health": "æª¢æŸ¥ PCE å¥åº·ç‹€æ…‹...",
        "checking_events": "æª¢æŸ¥äº‹ä»¶ (Events)...",
        "found_events": "  ç™¼ç¾ {count} å€‹äº‹ä»¶ã€‚",
        "processed_traffic_records": "  è™•ç†äº† {count} ç­†æµé‡ç´€éŒ„ã€‚",
        "trigger_alert": ">>> è§¸ç™¼å‘Šè­¦: {name}",
        "rule_cooldown": "è¦å‰‡ {name} å·²è§¸ç™¼ä½†è™•æ–¼å†·å»æ™‚é–“ä¸­ã€‚",
        
        "debug_mode_title": "=== æµé‡è¦å‰‡æ¨¡æ“¬èˆ‡é™¤éŒ¯ (Debug Mode) ===",
        "query_past_mins": "æŸ¥è©¢éŽåŽ»å¹¾åˆ†é˜çš„è³‡æ–™? [é è¨­: è‡ªå‹•åµæ¸¬æœ€å¤§è¦å‰‡æ™‚é–“]",
        "submitting_query": "æ­£åœ¨æäº¤æµé‡æŸ¥è©¢ ({start} è‡³ {end})...",
        "simulation_report": "=== æ¨¡æ“¬çµæžœå ±å‘Š ===",
        "fetched_records": "å…±å–å¾— {count} ç­†æµé‡è³‡æ–™ (Window: {mins} mins)ã€‚",
        "rule_header": "è¦å‰‡: {name} ({type})",
        "time_filter_results": "  -> [æ™‚é–“éŽæ¿¾] åŽŸå§‹è³‡æ–™: {total} -> è¦å‰‡è¦–çª—({win}m): å‰©é¤˜ {rem} ç­†",
        "calc_max_bw": "  -> è¨ˆç®—æœ€å¤§é »å¯¬ (Max): {val:.4} Mbps",
        "calc_sum_vol": "  -> è¨ˆç®—ç¸½å‚³è¼¸é‡ (Sum): {val:.4f} MB",
        "calc_sum_count": "  -> è¨ˆç®—ç¸½æ¬¡æ•¸ (Sum): {val:d}",
        "eval_result": "  -> åˆ¤å®šçµæžœ: {status} (é–¾å€¼: {threshold})",
        "samples_top10": "  -> æ¨£æœ¬ (Top 10):",
        "would_trigger": "ðŸ”´ æœƒè§¸ç™¼ (WOULD TRIGGER)",
        "pass": "ðŸŸ¢ é€šéŽ (PASS)",
        
        # Mail/Reporter HTML UI
        "no_recipients": "æœªè¨­å®šæ”¶ä»¶äººï¼Œç•¥éŽç™¼ä¿¡ã€‚",
        "mail_sent": "Email å·²é€éŽ {host}:{port} ç™¼é€ã€‚",
        "mail_failed": "Email ç™¼é€å¤±æ•—: {error}",
        "mail_subject": "[Illumio] å‘Šè­¦: ç™¼ç¾ {count} å€‹å•é¡Œ",
        "mail_subject_test": "[Illumio] æ¸¬è©¦å‘Šè­¦ä¿¡ä»¶",
        "report_header": "Illumio PCE Monitor ç›£æŽ§å ±å‘Š",
        "generated_at": "ç”¢ç”Ÿæ™‚é–“: {time}",
        "health_alerts_header": "ðŸš¨ ç³»çµ±å¥åº·ç‹€æ…‹å‘Šè­¦",
        "health_time": "æ™‚é–“",
        "health_status": "ç‹€æ…‹",
        "health_details": "è©³ç´°å…§å®¹",
        "security_events_header": "âš ï¸ è³‡å®‰äº‹ä»¶å‘Šè­¦",
        "event_time": "æ™‚é–“",
        "event_name": "äº‹ä»¶",
        "event_severity": "åš´é‡ç´šåˆ¥",
        "event_source": "ä¾†æº",
        "traffic_alerts_header": "ðŸ›¡ï¸ æµé‡é˜»æ“‹å‘Šè­¦",
        "traffic_rule": "è¦å‰‡åç¨±",
        "traffic_count": "æ¬¡æ•¸",
        "traffic_criteria": "è§¸ç™¼æ¢ä»¶",
        "traffic_toptalkers": "Top Talkers (å‰åå)",
        "metric_alerts_header": "ðŸ“Š æ•ˆèƒ½èˆ‡å‚³è¼¸é‡å‘Šè­¦",
        "raw_snapshot": "åŽŸå§‹å¿«ç…§:",
        "table_value": "æ¸¬é‡å€¼",
        "table_first_seen": "é¦–æ¬¡ç™¼ç¾",
        "table_last_seen": "æœ€å¾Œç™¼ç¾",
        "table_dir": "æ–¹å‘",
        "table_source": "ä¾†æº (Source)",
        "table_destination": "ç›®çš„ (Destination)",
        "table_service": "æœå‹™",
        "table_num_conns": "é€£ç·šæ•¸",
        "table_decision": "ç­–ç•¥",
        "decision_blocked": "\033[91må·²é˜»æ“‹\033[0m",
        "decision_potential": "\033[93mæ½›åœ¨é˜»æ“‹\033[0m",
        "decision_allowed": "\033[92må…è¨±\033[0m",

        # Alerters
        "line_alert_sent": "LINE å‘Šè­¦å·²é€å‡ºã€‚",
        "line_alert_failed": "LINE å‘Šè­¦å¤±æ•—: {error} / {status}",
        "line_config_missing": "æœªè¨­å®š LINE Token æˆ– Target IDï¼Œç•¥éŽ LINE å‘Šè­¦ã€‚",
        "webhook_alert_sent": "Webhook å‘Šè­¦å·²é€å‡ºã€‚",
        "webhook_alert_failed": "Webhook å‘Šè­¦å¤±æ•—: {error} / {status}",
        "webhook_url_missing": "æœªè¨­å®š Webhook URLï¼Œç•¥éŽ Webhook å‘Šè­¦ã€‚",

        # Web GUI
        "gui_title": "Illumio PCE Monitor",
        "gui_stop": "åœæ­¢",
        "gui_tab_dashboard": "ä¸»æŽ§å°",
        "gui_tab_rules": "ç›£æŽ§è¦å‰‡",
        "gui_tab_settings": "ç³»çµ±è¨­å®š",
        "gui_tab_actions": "åŸ·è¡Œå‹•ä½œ",
        "gui_api_status": "API ç‹€æ…‹",
        "gui_active_rules": "å•Ÿç”¨è¦å‰‡æ•¸",
        "gui_health_check": "å¥åº·æª¢æŸ¥",
        "gui_language": "èªžè¨€",
        "gui_test_conn": "æ¸¬è©¦é€£ç·š",
        "gui_refresh": "é‡æ–°æ•´ç†",
        "gui_param_guide": "åƒæ•¸æŒ‡å—",
        "gui_add_event": "+ äº‹ä»¶",
        "gui_add_traffic": "+ æµé‡",
        "gui_add_bw": "+ é »å¯¬/å‚³è¼¸é‡",
        "gui_delete": "åˆªé™¤",
        "gui_col_type": "é¡žåž‹",
        "gui_col_name": "åç¨±",
        "gui_col_status": "ç‹€æ…‹",
        "gui_col_condition": "è§¸ç™¼æ¢ä»¶",
        "gui_col_filters": "éŽæ¿¾æŒ‡æ¨™",
        "gui_col_edit": "ç·¨è¼¯",
        "gui_save_all": "å„²å­˜æ‰€æœ‰è¨­å®š",
        "gui_run_once": "ç«‹å³åŸ·è¡Œç›£æŽ§",
        "gui_run_once_desc": "åŸ·è¡Œå®Œæ•´æµç¨‹: å¥åº·æª¢æŸ¥ â†’ æŠ“å–è³‡æ–™ â†’ åˆ†æž â†’ å‘Šè­¦",
        "gui_run_btn": "åŸ·è¡Œ",
        "gui_debug_mode": "åµéŒ¯æ¨¡å¼",
        "gui_debug_desc": "æ²™ç›’æ¨¡å¼ â€” ä¸æœƒç™¼é€å‘Šè­¦ï¼Œä¸æ›´æ–°å…§éƒ¨ç‹€æ…‹",
        "gui_window_min": "è¦–çª— (åˆ†é˜)",
        "gui_policy_dec": "Policy Dec.",
        "gui_pd_blocked": "å·²é˜»æ“‹ (Blocked)",
        "gui_pd_allowed": "å…è¨± (Allowed)",
        "gui_pd_all": "å…¨éƒ¨ (All)",
        "gui_pd_potential": "æ½›åœ¨ (Potential)",
        "gui_run_debug": "åŸ·è¡ŒåµéŒ¯",
        "gui_test_alert": "ç™¼é€æ¸¬è©¦å‘Šè­¦",
        "gui_test_alert_desc": "æ¸¬è©¦ Email / LINE / Webhook å‘Šè­¦å¯„é€",
        "gui_send": "ç™¼é€",
        "gui_test_alert_desc": "æ¸¬è©¦ Email / LINE / Webhook å‘Šè­¦å¯„é€",
        "gui_send": "ç™¼é€",
        "gui_ta_query": "æµé‡åˆ†æžæŸ¥è©¢ (Traffic Analysis Query)",
        "gui_window": "æ™‚é–“ç¯„åœ (Window)",
        "gui_filter_details": "éŽæ¿¾è©³æƒ…",
        "gui_quick_search_placeholder": "å¿«é€Ÿæœå°‹å­—ä¸²...",
        "gui_sort_by": "æŽ’åºä¾æ“š",
        "gui_filter_settings": "éŽæ¿¾è¨­å®š",
        "gui_query_flow": "æŸ¥è©¢æµé‡",
        "gui_first_last_seen": "é¦–æ¬¡/æœ€å¾Œç™¼ç¾",
        "gui_metric": "æŒ‡æ¨™ (Metric)",
        "gui_source_identity": "ä¾†æºè­˜åˆ¥ (Source)",
        "gui_destination_identity": "ç›®çš„è­˜åˆ¥ (Destination)",
        "gui_service_port": "æœå‹™/é€šè¨ŠåŸ ",
        "gui_actions": "å‹•ä½œ",
        "gui_ws_search": "é€²éšŽå·¥ä½œè² è¼‰æœå°‹",
        "gui_win_15m": "éŽåŽ» 15 åˆ†é˜",
        "gui_win_1h": "éŽåŽ» 1 å°æ™‚",
        "gui_win_24h": "éŽåŽ» 24 å°æ™‚",
        "gui_win_1w": "éŽåŽ» 1 é€±",
        "gui_win_1m": "éŽåŽ» 1 å€‹æœˆ",
        "gui_traffic_analyzer": "æµé‡åˆ†æžå„€",
        "gui_workload_search": "å·¥ä½œè² è¼‰æœå°‹",
        "gui_top10_widgets": "Top 10 å°å·¥å…·",
        "gui_workload_name": "å·¥ä½œè² è¼‰åç¨±",
        "gui_ip_address": "IP ä½å€",
        "gui_hostname": "ä¸»æ©Ÿåç¨±",
        "gui_find": "æœå°‹",
        "gui_ws_empty": "è«‹è¼¸å…¥ IP æˆ–åç¨±ä»¥æœå°‹ PCE ä¸­çš„å·¥ä½œè² è¼‰ã€‚",
        "gui_ws_col_status": "ç‹€æ…‹ / åç¨±",
        "gui_ws_col_management": "ç®¡ç†ç‹€æ…‹",
        "gui_ws_col_ip": "IP èˆ‡ä»‹é¢",
        "gui_ws_col_labels": "ç”Ÿæ•ˆæ¨™ç±¤",
        "gui_status_online": "åœ¨ç·š",
        "gui_status_offline": "é›¢ç·š",
        "gui_management_managed": "å—ç®¡",
        "gui_management_unmanaged": "éžå—ç®¡",
        "gui_total_found_ws": "å…± {count} å°å·¥ä½œè² è¼‰",
        "gui_ta_guide_sec_search": "éŽæ¿¾è©³æƒ… / å³æ™‚æœå°‹",
        "gui_ta_guide_search_desc": "æ­¤æ¬„ä½æœƒå°å›žå‚³çš„çµæžœé€²è¡Œå³æ™‚æ¯”å°ï¼ˆæ”¯æ´å‰ 500 ç­†ï¼‰ï¼ŒåŒ…å«ï¼š",
        "gui_ta_guide_li_proc": "ç¨‹åºåç¨± (Process): ä¾‹å¦‚ sshd, nginx, java",
        "gui_ta_guide_li_user": "ä½¿ç”¨è€… (User): ä¾‹å¦‚ root, www-data, system",
        "gui_ta_guide_li_svc": "æœå‹™åç¨± (Service): ä¾‹å¦‚ HTTPS, MySQL",
        "gui_ta_guide_li_wn": "å·¥ä½œè² è¼‰åç¨±: ä¾‹å¦‚ web-server-01",
        "gui_ta_guide_li_ip": "IP ä½å€: ä¾‹å¦‚ 10.0.0.1",
        "gui_ta_guide_li_port": "é€šè¨ŠåŸ  (Port): ç›´æŽ¥è¼¸å…¥æ•¸å­—ï¼Œä¾‹å¦‚ 443",
        "gui_ta_guide_sec_adv": "é€²éšŽéŽæ¿¾è¨­å®š",
        "gui_ta_guide_adv_desc": "é€™äº›åƒæ•¸æœƒç›´æŽ¥éžäº¤çµ¦ Illumio API é€²è¡Œä¼ºæœå™¨ç«¯éŽæ¿¾ï¼š",
        "gui_ta_guide_li_labels": "æ¨™ç±¤ (Labels): è«‹ä½¿ç”¨ Key=Value æ ¼å¼ï¼Œä¾‹å¦‚ role=Web",
        "gui_ta_guide_li_excludes": "æŽ’é™¤æ¢ä»¶ (Excludes): å¯æŽ’é™¤ç‰¹å®š Portã€æ¨™ç±¤æˆ– IP æ®µ",
        "gui_ta_guide_li_pd": "æ”¿ç­–åˆ¤å®š: ç¯©é¸ Blocked, Allowed ç­‰é¡žåž‹",
        "gui_rank_bw": "æœ€å¤§é »å¯¬ (Mbps)",
        "gui_rank_vol": "ç¸½å‚³è¼¸é‡ (MB)",
        "gui_rank_conn": "é€£ç·šæ¬¡æ•¸",
        "gui_top10_loading": "è®€å–ä¸­...",
        "gui_top10_querying": "æŸ¥è©¢ä¸­...",
        "gui_top10_empty": "ç„¡è³‡æ–™ã€‚è«‹é»žæ“Šé‹è¡Œé–‹å§‹æŸ¥è©¢ã€‚",
        "gui_page_size": "æ¯é ç­†æ•¸",
        "gui_prev": "ä¸Šä¸€é ",
        "gui_next": "ä¸‹ä¸€é ",
        "gui_total_found": "å…± {count} ç­†ç´€éŒ„",
        "gui_ta_guide_title": "æµé‡åˆ†æžåƒæ•¸æŒ‡å—",
        "gui_ta_guide_desc": "æ‚¨å¯ä»¥åœ¨ã€ŒéŽæ¿¾è©³æƒ…ã€ä¸­è¼¸å…¥ç¨‹åºåç¨± (process)ã€ä½¿ç”¨è€… (user) æˆ–å·¥ä½œè² è¼‰åç¨±é€²è¡Œæœå°‹ã€‚",
        "gui_best_practices": "è¼‰å…¥æœ€ä½³å¯¦è¸",
        "gui_best_practices_desc": "ç”¨å®˜æ–¹å»ºè­°çš„é è¨­å€¼è¦†å¯« (è¦†å¯«æ‰€æœ‰ç¾æœ‰è¦å‰‡)",
        "gui_load": "è¼‰å…¥",
        "gui_output": "åŸ·è¡Œè¼¸å‡º",
        "gui_cancel": "å–æ¶ˆ",
        "gui_save": "å„²å­˜",
        "gui_api_conn": "API é€£ç·šè¨­å®š",
        "gui_url": "URL",
        "gui_org_id": "Org ID",
        "gui_api_key": "API Key",
        "gui_api_secret": "API Secret",
        "gui_verify_ssl": "é©—è­‰æ†‘è­‰ (Verify SSL)",
        "gui_email_smtp": "Email èˆ‡ SMTP",
        "gui_sender": "å¯„ä»¶äºº (Sender)",
        "gui_recipients": "æ”¶ä»¶äºº (å¤šå€‹ç”¨é€—è™Ÿåˆ†éš”)",
        "gui_smtp_host": "SMTP ä¸»æ©Ÿ",
        "gui_port": "Port",
        "gui_user": "ä½¿ç”¨è€…å¸³è™Ÿ",
        "gui_password": "å¯†ç¢¼",
        "gui_alert_channels": "å•Ÿç”¨çš„å‘Šè­¦é€šé“",
        "gui_mail": "Mail",
        "gui_line": "LINE",
        "gui_webhook": "Webhook",
        "gui_line_token": "LINE Token",
        "gui_line_target_id": "LINE Target ID",
        "gui_webhook_url": "Webhook URL",
        "gui_lang_settings": "é¡¯ç¤ºèˆ‡ä¸€èˆ¬è¨­å®š (Display & General)",
        "gui_lang_en": "English",
        "gui_lang_zh": "ç¹é«”ä¸­æ–‡",
        "gui_theme_dark": "æš—é»‘ä¸»é¡Œ (Dark)",
        "gui_theme_light": "æ˜Žäº®ä¸»é¡Œ (Light)",
        "gui_add_event_rule": "æ–°å¢žäº‹ä»¶è¦å‰‡",
        "gui_edit_event_rule": "ç·¨è¼¯äº‹ä»¶è¦å‰‡",
        "gui_category": "äº‹ä»¶é¡žåˆ¥",
        "gui_event_type": "äº‹ä»¶é¡žåž‹",
        "gui_select": "è«‹é¸æ“‡...",
        "gui_select_first": "è«‹å…ˆé¸æ“‡é¡žåˆ¥",
        "gui_threshold": "è§¸ç™¼é–¾å€¼",
        "gui_type": "è¨ˆç®—æ–¹å¼",
        "gui_tt_immediate": "ç«‹å³è§¸ç™¼",
        "gui_tt_count": "ç´¯ç©æ¬¡æ•¸",
        "gui_count": "æ¬¡æ•¸",
        "gui_cooldown": "å†·å»æ™‚é–“ (åˆ†)",
        "gui_enable_hc": "å•Ÿç”¨ PCE å¥åº·æª¢æŸ¥ç›£æŽ§",
        "gui_add_traffic_rule": "æ–°å¢žæµé‡è¦å‰‡",
        "gui_edit_traffic_rule": "ç·¨è¼¯æµé‡è¦å‰‡",
        "gui_rule_name": "è¦å‰‡åç¨±",
        "gui_protocol": "é€šè¨Šå”å®š",
        "gui_both": "å…©è€… (Both)",
        "gui_tcp": "TCP",
        "gui_udp": "UDP",
        "gui_source": "ä¾†æº (æ¨™ç±¤/IP)",
        "gui_dest": "ç›®çš„ (æ¨™ç±¤/IP)",
        "gui_excludes": "æŽ’é™¤æ¢ä»¶ (é¸å¡«)",
        "gui_ex_port": "æŽ’é™¤ Port",
        "gui_ex_src": "æŽ’é™¤ä¾†æº",
        "gui_run_all_queries": "åŸ·è¡Œå…¨éƒ¨æŸ¥è©¢",
        "gui_add_query_widget": "æ–°å¢žæŸ¥è©¢å ±è¡¨",
        "gui_query_widget_name": "å ±è¡¨åç¨±",
        "gui_ex_dest": "æŽ’é™¤ç›®çš„",
        "gui_add_bw_rule": "æ–°å¢žé »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡",
        "gui_edit_bw_rule": "ç·¨è¼¯é »å¯¬èˆ‡å‚³è¼¸é‡è¦å‰‡",
        "gui_metric_type": "ç›£æŽ§æŒ‡æ¨™é¡žåž‹",
        "gui_mt_bw": "é »å¯¬ (Mbps, Max)",
        "gui_mt_vol": "å‚³è¼¸é‡ (MB, Sum)",
        "gui_value": "æ•¸å€¼",
        "gui_top10_title": "Top 10 æŸ¥è©¢å ±è¡¨",
        "gui_rank_by": "æŽ’åºä¾æ“š",
        "gui_rank_count": "é€£ç·šæ•¸ (Connection Count)",
        "gui_rank_volume": "ç¸½å‚³è¼¸é‡ (Total Volume MB)",
        "gui_rank_bw": "æœ€å¤§é »å¯¬ (Max Bandwidth Mbps)",
        "gui_top10_flow": "ä¾†æº -> ç›®çš„ [Port]",
        "gui_top10_empty": "ç„¡è³‡æ–™ã€‚é»žæ“ŠåŸ·è¡Œé–‹å§‹æŸ¥è©¢ã€‚",
        "gui_top10_querying": "æŸ¥è©¢ä¸­...",
        "gui_top10_loading": "è¼‰å…¥ä¸­...",
        "gui_top10_found": "æ‰¾åˆ° {count} ç­†ç´€éŒ„ã€‚(é¡¯ç¤º Top 10)",
        "gui_top10_no_records": "æœªæ‰¾åˆ°ä»»ä½•ç´€éŒ„ã€‚",
        "gui_top10_error": "æŸ¥è©¢è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚",
        "gui_cooldown_title": "å†·å»ä¸­çš„è¦å‰‡",
        "gui_cooldown_remaining": "å‰©é¤˜ {mins} åˆ†é˜",
        "gui_cooldown_active": "å†·å»ä¸­",
        "gui_cooldown_ready": "å°±ç·’",

        # Event Descriptions
        "event_agent_missed_heartbeats": "éºå¤±å¿ƒè·³",
        "event_agent_offline": "Agent é›¢ç·š",
        "event_lost_agent_found": "é‡æ–°ç™¼ç¾éºå¤± Agent",
        "event_service_not_available": "Agent æœå‹™ä¸å¯ç”¨",
        "event_agent_goodbye": "Agent Goodbye",
        "event_agent_tampering": "Agent é­åˆ°ç«„æ”¹",
        "event_agent_suspend": "Agent è¢«æš«åœ",
        "event_agent_clone_detected": "åµæ¸¬åˆ°è¤‡è£½ Agent",
        "event_agent_activate": "Agent å·²é…å°",
        "event_agent_deactivate": "Agent å–æ¶ˆé…å°",
        "event_user_login_failed": "ç™»å…¥å¤±æ•—",
        "event_user_sign_in": "ä½¿ç”¨è€…ç™»å…¥",
        "event_csrf_failed": "CSRF é©—è­‰å¤±æ•—",
        "event_api_auth_failed": "API èªè­‰å¤±æ•—",
        "event_api_authz_failed": "API æŽˆæ¬Šå¤±æ•—",
        "event_api_key_create": "å»ºç«‹ API Key",
        "event_api_key_delete": "åˆªé™¤ API Key",
        "event_ruleset_delete": "åˆªé™¤è¦å‰‡é›†",
        "event_ruleset_create": "å»ºç«‹è¦å‰‡é›†",
        "event_ruleset_update": "æ›´æ–°è¦å‰‡é›†",
        "event_rule_create": "å»ºç«‹è¦å‰‡",
        "event_rule_delete": "åˆªé™¤è¦å‰‡",
        "event_policy_prov": "æ”¿ç­–æ´¾é€ (Provisioning)",
        "event_workload_create": "å»ºç«‹å·¥ä½œè² è¼‰",
        "event_workload_delete": "åˆªé™¤å·¥ä½œè² è¼‰",
        "event_pce_start": "PCE å•Ÿå‹•",
        "event_cluster_update": "å¢é›†æ›´æ–°",
        
        "selected": "å·²é¸æ“‡",
        "setup_smtp": "=== SMTP è¨­å®š ===",
    }
}

def t(key: str, **kwargs) -> str:
    """Translates a key into the currently selected language."""
    text = MESSAGES.get(_current_lang, MESSAGES["en"]).get(key, key)
    
    if kwargs:
        try:
            return text.format(**kwargs)
        except Exception:
            return text
    return text
